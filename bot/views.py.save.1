from django.shortcuts import render
from django.http import HttpResponse
from django.views.decorators.csrf import csrf_exempt
import json

import json 
import requests
import time
import urllib

TOKEN = "503272342:AAErMqu04JmlmFen9pYX9dlhmFVrq8Y7Ypg"
URL = "https://api.telegram.org/bot{}/".format(TOKEN)

def get_url(url):
    response = requests.get(url)
    content = response.content.decode("utf8")
    return content

def handle_update(update):
    try:
        text = update["message"]["text"]
        chat = update["message"]["chat"]["id"]
        send_message(text, chat)
    except KeyError:
        pass

def send_message(text, chat_id):
    text = urllib.parse.quote_plus(text)
    url = URL + "sendMessage?text={}&chat_id={}".format(text, chat_id)
    get_url(


@csrf_exempt
def index(request):
    if request.method == "POST":
        print("Printing Request")
        print(json.loads(request.body.decode("utf-8")))
	print("Getting URL")
	print(request.get(url))
        return HttpResponse("Got a post mate")
    return HttpResponse('Hello World')
